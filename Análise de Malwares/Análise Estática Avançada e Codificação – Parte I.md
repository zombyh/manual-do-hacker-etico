
## 📘 Resumo: Análise Estática Avançada e Codificação – Parte I

### 📌 Objetivos da Aula
- Identificar características da arquitetura Intel x86.
- Compreender as diferenças entre bases numéricas (binária, decimal, hexadecimal).
- Reconhecer e interpretar comandos em linguagem Assembly.

---

## 🧠 Arquitetura de Computadores

### 🧩 Níveis de Abstração
- **Hardware**: Circuitos físicos.
- **Microcódigo (Firmware)**: Interface entre hardware e código de máquina.
- **Código de Máquina**: Opcodes em hexadecimal.
- **Linguagem de Baixo Nível (Assembly)**: Versão legível do código de máquina.
- **Linguagem de Alto Nível**: Ex.: C, C++.
- **Linguagens Interpretadas**: Ex.: Java, .NET, Perl (bytecode + interpretador).

### 🔁 Arquitetura Von Neumann
- **CPU**: Executa instruções.
- **Memória Principal (RAM)**: Armazena código e dados.
- **Sistema de E/S**: Interface com dispositivos externos.

#### Componentes da CPU:
- **Unidade de Controle**: Busca instruções da RAM via **EIP**.
- **Registradores**: Armazenamento rápido de dados.
- **ULA**: Executa operações lógicas e aritméticas.

---

## 🧩 Memória de um Programa

| Seção   | Função |
|---------|--------|
| **Dados** | Variáveis estáticas/globais |
| **Código** | Instruções do programa |
| **Heap** | Alocação dinâmica |
| **Pilha** | Variáveis locais, parâmetros, controle de fluxo |

---

## 💻 Linguagem Assembly

### 🧩 Estrutura de uma Instrução
```
Mnemonico Operando1, Operando2
```
- **Mnemonico**: Identifica a operação (ex.: `mov`, `add`).
- **Operando**: Dados usados pela instrução.

### 🔢 Tipos de Operandos
1. **Imediato**: Valor fixo (ex.: `0x42`).
2. **Registrador**: Ex.: `eax`, `ebx`.
3. **Endereço de Memória**: Ex.: `[eax]`, `[0x11223344]`.

---

## 🔁 Ordem dos Bytes (Endianness)
- **Little-endian**: Byte menos significativo primeiro (usado em x86).
- **Big-endian**: Byte mais significativo primeiro (usado em rede).

Exemplo: IP `127.0.0.1` →  
- Big-endian: `0x7F000001`  
- Little-endian: `0x0100007F`

---

## 🔢 Bases Numéricas

| Binário | Decimal | Hexadecimal |
|---------|---------|-------------|
| 0       | 0       | 0           |
| 1       | 1       | 1           |
| 10      | 2       | 2           |
| ...     | ...     | ...         |
| 1111    | 15      | F           |

- 1 byte = 8 bits = 2 hexadecimais.

---

## 🧮 Registradores x86

### Categorias:
- **Gerais**: EAX, EBX, ECX, EDX, EBP, ESP, ESI, EDI.
- **Segmento**: CS, SS, DS, ES, FS, GS.
- **Status**: EFLAGS.
- **Ponteiro de Instrução**: EIP.

### Exemplo: EAX
- EAX (32 bits) → AX (16 bits) → AH (8 bits superiores) + AL (8 bits inferiores).

---

## 🚩 Flags (EFLAGS)

| Flag | Significado |
|------|-------------|
| **ZF** | Resultado = 0 |
| **CF** | Overflow/Underflow |
| **SF** | Resultado negativo |
| **TF** | Modo de depuração (uma instrução por vez) |

---

## 🧾 Instruções Assembly Comuns

### ➡️ `mov destino, origem`
- Copia o valor da origem para o destino.
- Ex.: `mov ecx, eax` → copia EAX para ECX.

### 🧭 `lea destino, [origem]`
- Calcula e armazena o **endereço efetivo**.
- Ex.: `lea eax, [ebx+8]` → EAX = EBX + 8.

### ➕ `add destino, origem` / `sub destino, origem`
- Soma/subtrai origem ao destino e armazena no destino.

### ✖️ `mul valor` / `div valor`
- Multiplicação/divisão usam EDX:EAX.
- Resultado de 64 bits: EDX (parte alta) + EAX (parte baixa).

### 🔁 Operadores Lógicos
- `and`, `or`, `xor`: operação bit a bit.

### 🔀 Deslocamento de Bits
- `shl destino, bits`: desloca para a esquerda.
- `shr destino, bits`: desloca para a direita.
- Ex.: `1000` → `shl 1` → `10000`; `shr 1` → `0100`.

---

## 🧪 Exemplos Práticos

### Exemplo 1:
```asm
mov eax, 0x01020304
add eax, 0x02030405
lea ebx, [eax+8]
```
- EAX = 0x03050709
- EBX = 0x03050711

### Exemplo 2:
- Valor binário: `101001 + 1110100` = `10011101` → hexa: `0x9D`
- Hexadecimal: `0xA0F21 – 0x9F134` = `0x1FED` → decimal: 7661
- Decimal: `12 + 10` = `22` → binário: `10110`

---

## 📚 Referências
- SIKORSKI, M. **Practical Malware Analysis**
- TANENBAUM, A.S. **Organização Estruturada de Computadores**
- NLEY, C. **The Shellcoder’s Handbook**

---

## 🎯 Próximos Tópicos
- Ferramentas para análise de código assembly.
- Relação entre instruções em C e Assembly.

---
