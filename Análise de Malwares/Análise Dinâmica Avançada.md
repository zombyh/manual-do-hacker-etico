
## ğŸ“˜ Resumo: AnÃ¡lise DinÃ¢mica AvanÃ§ada

### ğŸ“Œ VisÃ£o Geral
- Esta aula aborda **anÃ¡lise dinÃ¢mica avanÃ§ada** usando depuradores.
- Foco em duas ferramentas:
  - **OllyDbg**: depuraÃ§Ã£o em modo de usuÃ¡rio.
  - **WinDbg**: depuraÃ§Ã£o em modo kernel.

---

## ğŸ› ï¸ Depuradores (Debuggers)

### ğŸ”¹ O que sÃ£o?
- Softwares que permitem **testar e examinar a execuÃ§Ã£o de um programa**.
- Fornecem uma **visÃ£o dinÃ¢mica** (em tempo real) do programa, diferente do disassembly (estÃ¡tico).
- Permitem:
  - Ver registradores, memÃ³ria, argumentos de funÃ§Ãµes.
  - Alterar valores durante a execuÃ§Ã£o.

### ğŸ”¹ Modo de UsuÃ¡rio vs. Modo Kernel
- **Modo UsuÃ¡rio**:
  - A maioria dos programas executa aqui.
  - Processos isolados, com prÃ³pria memÃ³ria.
  - InstruÃ§Ãµes restritas.
  - Se crashar, nÃ£o afeta o SO.
- **Modo Kernel**:
  - SO e drivers.
  - Acesso total ao hardware.
  - Compartilham memÃ³ria.
  - Crash = tela azul (BSOD).

---

## ğŸ” OllyDbg â€“ Depurador de Modo UsuÃ¡rio

### ğŸ”¸ CaracterÃ­sticas
- GrÃ¡tis, popular, com suporte a plugins.
- Interface com 4 janelas principais:

1. **Janela do Desmontador**: CÃ³digo em assembly.
2. **Janela de Registradores**: Estado dos registradores.
3. **Janela da Pilha**: Estado da pilha do processo.
4. **Janela de MemÃ³ria**: VisualizaÃ§Ã£o de qualquer regiÃ£o de memÃ³ria.

### ğŸ”¸ Controles de ExecuÃ§Ã£o
- **Step Into**: Entra na funÃ§Ã£o.
- **Step Over**: Executa a funÃ§Ã£o sem entrar nela.
- **Run**: Continua a execuÃ§Ã£o.
- **Run to Selection**: Executa atÃ© a instruÃ§Ã£o selecionada.
- **Breakpoints**: Pausa em pontos especÃ­ficos.

### ğŸ”¸ DepuraÃ§Ã£o de DLLs
- Usa `loaddll.exe` para carregar DLLs.
- Permite depurar `DllMain` e funÃ§Ãµes exportadas.

### ğŸ”¸ Mapeamento de MemÃ³ria
- Mostra todas as seÃ§Ãµes de memÃ³ria do processo.
- Ãštil para ver cÃ³digo, dados, DLLs carregadas.

### ğŸ”¸ Threads
- VisualizaÃ§Ã£o e controle de threads.
- Possibilidade de pausar, matar ou depurar threads especÃ­ficas.

---

## âš™ï¸ WinDbg â€“ Depurador de Modo Kernel

### ğŸ”¸ Uso Principal
- DepuraÃ§Ã£o de **drivers**, **rootkits**, cÃ³digo em modo kernel.

### ğŸ”¸ Como Funciona o Kernel no Windows
- **Drivers**: CÃ³digo que roda no kernel.
- **Device Objects**: Objetos que aplicativos acessam (ex: unidade D:).
- **DriverEntry**: Ponto de entrada do driver (como `DllMain` para DLLs).

### ğŸ”¸ Comandos Principais no WinDbg
- **`d`**: Exibe memÃ³ria (ex: `da` para ASCII, `du` para Unicode).
- **`dwo`**: LÃª ponteiro de 32 bits.
- **`bp`**: Define breakpoint (ex: `bp GetProcAddress "da dwo(esp+8); g"`).
- **`!devobj`**: InformaÃ§Ãµes do objeto de dispositivo.
- **`!devhandles`**: Lista processos com handle para o dispositivo.

### ğŸ”¸ Rootkits e SSDT Hooking
- **SSDT (System Service Descriptor Table)**: Tabela de funÃ§Ãµes do kernel.
- **Hooking**: Rootkits alteram entradas na SSDT para redirecionar chamadas.
- Exemplo: Substituir `NtCreateFile` para ocultar arquivos.

---

## ğŸ§ª TÃ©cnicas de DepuraÃ§Ã£o

### ğŸ”¹ Tipos de DepuraÃ§Ã£o
1. **Iniciar com Depurador**: Controle desde o inÃ­cio.
2. **Anexar a Processo**: Depurar programa jÃ¡ em execuÃ§Ã£o.

### ğŸ”¹ Breakpoints
- Pausam a execuÃ§Ã£o para inspeÃ§Ã£o.
- Exemplo: Breakpoint em `CreateFile` para ver nome do arquivo.

### ğŸ”¹ ModificaÃ§Ã£o da ExecuÃ§Ã£o
- Alterar registradores (ex: EIP).
- Pular chamadas de funÃ§Ã£o.
- Modificar valores na memÃ³ria.

---

## ğŸ“š ReferÃªncias Sugeridas
- Anley (2007)  
- Sikorski & Honig (2012)  
- Tanenbaum (2010)  
- Matrosov: *Rootkits and Bootkits*

---
