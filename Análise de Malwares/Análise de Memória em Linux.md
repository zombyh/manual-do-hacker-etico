
## 📘 Resumo: Análise de Memória em Linux

### 🎯 Objetivo da Aula
- Identificar técnicas de aquisição de memória em Linux.
- Construir perfis do sistema operacional Linux para uso no Volatility.
- Reconhecer recursos internos do ambiente Linux para análise forense.

---

## 🧠 Tópicos Principais

### 1. Introdução ao Linux e Sua Importância Forense
- Linux é um sistema baseado em UNIX, de código aberto e gratuito.
- Diferente do Windows, exige a criação de perfis específicos para análise com o Volatility.

---

### 2. Aquisição de Memória no Linux

#### 📌 Métodos Antigos
- Uso de `/dev/mem` e `/dev/kmem` para leitura direta da memória física.
- **Problema**: Desativados em sistemas modernos por questões de segurança.

#### 📌 Métodos Modernos
- **`fmem`**: Driver que cria o dispositivo `/dev/fmem` para acesso à memória física.
  - ✅ Vantagens: Acessa memória acima de 896 MB; evita leitura de áreas não mapeadas.
  - ❌ Desvantagem: Exige análise manual de `/proc/iomem` para identificar segmentos de RAM.

- **LIME (Linux Memory Extractor)**:
  - ✅ Faz aquisição diretamente no kernel.
  - ✅ Detecta automaticamente os intervalos de memória.
  - ✅ Suporta saída em formato **raw**, **padded** ou **lime** (recomendado).
  - ✅ Pode salvar localmente ou enviar via rede.

**Exemplo de uso do LIME:**
```bash
# Salvar localmente
insmod lime.ko "path=/tmp/memoria.lime format=lime"

# Enviar via rede
insmod lime.ko "path=tcp:443 format=lime"
nc <IP_ALVO> 443 > memoria.lime
```

---

### 3. Criação de Perfis Linux para o Volatility

#### Por que criar perfis?
- Linux possui milhares de versões de kernel personalizadas.
- Volatility não inclui todos os perfis possíveis.

#### 📌 Ferramentas Necessárias:
- `dwarfdump`
- `gcc`, `make` (pacote `build-essential`)
- Cabeçalhos do kernel (`linux-headers-$(uname -r)`)

#### 📌 Passos para Criar um Perfil:
1. Compilar `module.c` do Volatility:
   ```bash
   cd /usr/share/volatility/tools/linux
   make
   ```
2. Gerar `module.dwarf` com `dwarfdump`.
3. Obter `System.map` do diretório `/boot`.
4. Compactar ambos em um arquivo ZIP e mover para:
   ```
   volatility/plugins/overlays/linux/
   ```
5. Verificar com:
   ```bash
   volatility --info | grep "NomeDoPerfil"
   ```

---

### 4. Análise de Processos e Memória

#### 📌 Estrutura de Processos no Linux
- Cada processo é representado por uma estrutura no kernel.
- Lista de processos ativos não é visível ao usuário.
- **Plugin do Volatility**: `linux_pslist`

#### 📌 Objetivos do Analista:
- Classificar a memória do processo (heap, stack, código).
- Extrair argumentos da linha de comando.
- Analisar variáveis de ambiente.
- Detectar injeção de bibliotecas compartilhadas.

---

### 5. Análise de Rede

#### 📌 Plugin: `linux_netstat`
- Recupera conexões de rede a partir da memória.
- Similar ao `netstat`, mas sem usar APIs do sistema.

#### 📌 Objetivos:
- Recuperar informações de conexão (IP, porta, estado).
- Detectar conexões maliciosas (C2, exfiltração).

---

### 6. Sistemas de Arquivos

#### 📌 Plugin: `linux_mount`
- Lista sistemas de arquivos montados no momento da aquisição.

#### 📌 Objetivos:
- Identificar compartilhamentos de rede montados.
- Detectar vazamento de dados.
- Entender partições e sistemas de arquivos temporários (ex.: `tmpfs`).

---

### 7. Detecção de Rootkits

#### 📌 Tipos de Rootkits:
- **Modo Usuário**:
  - Mais portáteis, menos detectáveis.
- **Modo Kernel**:
  - Mais poderosos, mas mais difíceis de manter e mais visíveis.

#### 📌 Técnicas Maliciosas a Investigar:
- Injeção de shellcode.
- Injeção de bibliotecas compartilhadas.
- Sobrescrição da GOT/PLT.
- Rastreamento de ligações de funções em linha.

---

### 8. Exercícios de Revisão

1. **Dispositivo para aquisição em sistemas 64-bit modernos:**
   - ✅ `/proc/score`

2. **Item NÃO necessário para criar um perfil Linux:**
   - ❌ `Dumpit`

3. **Item NÃO foco direto na análise de memória para malwares:**
   - ❌ `Senhas de usuário`

---

### 📚 Referências Principais
- LIGH, M.H. et al. *The Art of Memory Forensics*.
- ANLEY, C. *The Shellcoder's Handbook*.
- TANENBAUM, A.S. *Organização Estruturada de Computadores*.

---

### 🧩 Próximos Temas
- Revisão de assembly ARM.
- Análise de malwares em Android e iOS.

---
